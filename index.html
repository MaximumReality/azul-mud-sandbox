<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Azul & Mochkil: Maximum Reality</title>
<style>
  body {
    background: #0a0a23;
    color: #00ffff;
    font-family: monospace;
    margin: 0;
    padding: 0;
    text-shadow: 0 0 6px #00ffff;
    overflow-x: hidden;
  }
  .container {
    max-width: 420px;
    margin: auto;
    padding: 12px 12px 80px 12px;
    position: relative;
  }
  @keyframes glitch-flicker {
    0% { opacity: 0.9; }
    50% { opacity: 1; }
    100% { opacity: 0.9; }
  }
  .vault-active { animation: glitch-flicker 0.2s infinite; }
  h1 {
    margin-top: 80px;
    text-align: center;
    color: #ffcc00;
    text-shadow: 0 0 10px #ffcc00;
    font-size: 1.4em;
  }
  #story { min-height: 140px; margin: 10px 0; line-height: 1.4; }
  #loading, #dice { color: #ff66cc; text-shadow: 0 0 6px #ff66cc; font-weight: bold; }
  #dice { cursor: pointer; font-size: 1.5em; display: inline-block; margin-bottom: 10px; }
  #actions button {
    display: block; width: 100%; margin: 6px 0; padding: 12px;
    font-size: 1em; background: #111144; color: #fff; 
    border: 1px solid #00ffff; border-radius: 4px;
  }
  #inventory { margin-top: 15px; color: #ffcc66; font-size: 0.9em; border-top: 1px solid #333; padding-top: 10px; }
  #inputRow { display: flex; gap: 6px; margin-top: 15px; }
  #inputRow input { flex: 1; padding: 10px; background: #111133; color: #00ffff; border: 1px solid #00ffff; border-radius: 4px; }
  #inputRow button { background: #333366; color: #fff; border: 1px solid #00ffff; padding: 10px; border-radius: 4px; }
  img.sprite { position: absolute; width: 64px; image-rendering: pixelated; z-index: 5; transition: all 0.3s ease; }
  #azul { top: 10px; left: 10px; filter: drop-shadow(0 0 5px #00ffff); }
  #mochkil { top: 10px; right: 10px; filter: drop-shadow(0 0 5px #ff66cc); }
</style>
</head>

  <body>
<div class="container">
  <img id="azul" class="sprite" src="https://raw.githubusercontent.com/MaximumReality/azul-story-cyoa-sandbox/main/azul.png">
  <img id="mochkil" class="sprite" src="https://raw.githubusercontent.com/MaximumReality/azul-story-cyoa-sandbox/main/mochkil.png">

  <h1>Azul & Mochkil: Maximum Reality</h1>

  <div id="story"></div>
  <div id="loading" style="display:none">ðŸ’¾ SYNCING_REALITY...</div>
  <div id="dice">ðŸŽ² Roll Dice</div>
  <div id="actions"></div>
  <div id="inventory">ðŸŽ’ DATA_PACKETS: EMPTY</div>

  <div id="inputRow">
    <input id="userInput" placeholder="Enter command">
    <button id="sendBtn">Send</button>
  </div>
</div>
<script>
// --- STATE ---
let currentRoom = 'lab';
let inventory = [];
let typing = false;

// --- DOM ELEMENTS ---
const storyEl = document.getElementById('story');
const actionsEl = document.getElementById('actions');
const inventoryEl = document.getElementById('inventory');
const loadingEl = document.getElementById('loading');

// --- ROOMS DATA ---
const rooms = {
  lab: { description: "You are in the Glowing Lab. Test tubes bubble with quantum foam.", actions:["Inspect test tubes","Give elixir to Azul","Go to Library","Go to Courtyard", "Go to Pantry"] },
  pantry: { description: "The Secret Pantry. Chef Mochkil is guarding the exit to the Forest.", actions:["Take cookie","Give cookie to Mochkil","Return to Lab"] },
  potionChamber: { description: "A hidden chamber filled with glowing potions.", actions:["Take sparkling elixir","Return to Lab"] },
  library: { description: "Endless shelves of dusty books.", actions:["Read a book","Go to Potion Chamber","Return to Lab"] },
  courtyard: { description: "A courtyard with a fountain.", actions:["Pick a mushroom","Go to Forest","Return to Lab"] },
  forest: { description: "The Mysterious Forest.", actions:["Pick glowing mushroom","Talk to squirrel","Trade mushroom","Return to Courtyard"] },
  vault: { description: "MAINFRAME_HEART.", actions:["RESTART_SIMULATION"] }
};

// --- CORE FUNCTIONS ---
function typeWriter(text, cb){ 
  if(typing) return; typing = true; storyEl.textContent = ''; let i = 0; 
  (function step(){ 
    if(i < text.length){ storyEl.textContent += text[i++]; setTimeout(step, 25); } 
    else { typing = false; if(cb) cb(); } 
  })(); 
}

function updateInventory(){ inventoryEl.innerHTML = "ðŸŽ’ DATA_PACKETS: " + (inventory.length ? inventory.join(' | ') : 'EMPTY'); }

function renderActions(){ 
  actionsEl.innerHTML = ''; 
  rooms[currentRoom].actions.forEach(a => { 
    const b = document.createElement('button'); b.textContent = a; 
    b.onclick = () => handleAction(a); actionsEl.appendChild(b); 
  }); 
}

function renderRoom(){ 
  actionsEl.innerHTML = '';
  typeWriter(rooms[currentRoom].description, () => { 
    renderActions();
    document.getElementById('azul').style.display = (currentRoom === 'lab') ? "block" : "none";
    document.getElementById('mochkil').style.display = (currentRoom === 'pantry') ? "block" : "none";
  }); 
}

// --- THE ACTION ENGINE ---
function handleAction(action){
  if(typing) return;
  const input = action.toLowerCase();
  actionsEl.innerHTML = ''; 

  // 1. QUEST: GIVE ELIXIR
  if(input.includes("give elixir")){
    if(inventory.includes("sparkling elixir") && currentRoom === 'lab'){
      inventory = inventory.filter(i => i !== "sparkling elixir"); updateInventory();
      typeWriter("Azul drinks. 'Power restored! The Forest is scanned.'", renderActions);
    } else { typeWriter("Azul needs the elixir first.", renderActions); }
    return;
  }

  // 2. QUEST: GIVE COOKIE
  if(input.includes("give cookie")){
    if(inventory.includes("cookie") && currentRoom === 'pantry'){
      inventory = inventory.filter(i => i !== "cookie"); updateInventory();
      typeWriter("Mochkil eats the cookie and moves aside! 'Forest open!'", renderActions);
    } else { typeWriter("Mochkil hisses: 'No cookie, no forest!'", renderActions); }
    return;
  }

  // 3. ITEM LOGIC
  if(input.includes("take cookie")){ inventory.push("cookie"); updateInventory(); typeWriter("You got a cookie!", renderActions); return; }
  if(input.includes("take sparkling elixir")){ inventory.push("sparkling elixir"); updateInventory(); typeWriter("You got the elixir!", renderActions); return; }

  // 4. NAVIGATION
  const destinations = ["lab", "pantry", "chamber", "library", "courtyard", "forest", "vault"];
  let found = destinations.find(d => input.includes(d));
  if(found){
    if(found === "chamber") currentRoom = 'potionChamber';
    else currentRoom = found;
    renderRoom(); return;
  }

  // 5. FALLBACK
  typeWriter(`You attempt to ${action}. Reality flickers.`, renderActions);
}

// --- BOOT ---
updateInventory();
renderRoom();
</script>
</body>
</html>
